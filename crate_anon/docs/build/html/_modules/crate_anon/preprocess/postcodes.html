
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>crate_anon.preprocess.postcodes &#8212; CRATE  documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/crate_docs.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">CRATE  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for crate_anon.preprocess.postcodes</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># crate_anon/tools/postcodes.py</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">===============================================================================</span>

<span class="sd">    Copyright (C) 2015-2018 Rudolf Cardinal (rudolf@pobox.com).</span>

<span class="sd">    This file is part of CRATE.</span>

<span class="sd">    CRATE is free software: you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU General Public License as published by</span>
<span class="sd">    the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>

<span class="sd">    CRATE is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<span class="sd">    GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License</span>
<span class="sd">    along with CRATE. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="sd">===============================================================================</span>

<span class="sd">Code-Point Open, CSV, GB</span>
<span class="sd">- https://www.ordnancesurvey.co.uk/business-and-government/products/opendata-products.html</span>
<span class="sd">- https://www.ordnancesurvey.co.uk/business-and-government/products/code-point-open.html</span>
<span class="sd">- https://www.ordnancesurvey.co.uk/opendatadownload/products.html</span>
<span class="sd">- http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/</span>

<span class="sd">Office for National Statistics Postcode Database (ONSPD):</span>
<span class="sd">- https://geoportal.statistics.gov.uk/geoportal/catalog/content/filelist.page</span>
<span class="sd">- e.g. ONSPD_MAY_2016_csv.zip</span>
<span class="sd">- http://www.ons.gov.uk/methodology/geography/licences</span>

<span class="sd">Background:</span>
<span class="sd">- OA = Output Area</span>
<span class="sd">    ... smallest: &gt;=40 households, &gt;=100 people</span>
<span class="sd">    ... 181,408 OAs in England &amp; Wales</span>
<span class="sd">- LSOA = Lower Layer Super Output Area</span>
<span class="sd">    ... 34,753 LSOAs in England &amp; Wales</span>
<span class="sd">- MSOA = Middle Layer Super Output Area</span>
<span class="sd">    ... 7,201 MSOAs in England &amp; Wales</span>
<span class="sd">- WZ = Workplace Zone</span>
<span class="sd">    - https://www.ons.gov.uk/methodology/geography/ukgeographies/censusgeography#workplace-zone-wz</span>
<span class="sd">- https://www.ons.gov.uk/methodology/geography/ukgeographies/censusgeography#output-area-oa</span>
<span class="sd">&quot;&quot;&quot;</span>  <span class="c1"># noqa</span>

<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="c1"># import textwrap</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">TextIO</span>

<span class="kn">from</span> <span class="nn">cardinal_pythonlib.dicts</span> <span class="k">import</span> <span class="n">rename_key</span>
<span class="kn">from</span> <span class="nn">cardinal_pythonlib.extract_text</span> <span class="k">import</span> <span class="n">docx_process_simple_text</span>
<span class="kn">from</span> <span class="nn">cardinal_pythonlib.fileops</span> <span class="k">import</span> <span class="n">find_first</span>
<span class="kn">from</span> <span class="nn">cardinal_pythonlib.logs</span> <span class="k">import</span> <span class="n">configure_logger_for_colour</span>
<span class="kn">import</span> <span class="nn">openpyxl</span>
<span class="kn">from</span> <span class="nn">openpyxl.cell.cell</span> <span class="k">import</span> <span class="n">Cell</span>
<span class="kn">import</span> <span class="nn">prettytable</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">Column</span><span class="p">,</span>
    <span class="n">create_engine</span><span class="p">,</span>
    <span class="n">Date</span><span class="p">,</span>
    <span class="n">Integer</span><span class="p">,</span>
    <span class="n">MetaData</span><span class="p">,</span>
    <span class="n">Numeric</span><span class="p">,</span>
    <span class="n">String</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.ext.declarative</span> <span class="k">import</span> <span class="n">declarative_base</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="k">import</span> <span class="n">sessionmaker</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm.session</span> <span class="k">import</span> <span class="n">Session</span>
<span class="kn">import</span> <span class="nn">xlrd</span>

<span class="kn">from</span> <span class="nn">crate_anon.anonymise.constants</span> <span class="k">import</span> <span class="n">CHARSET</span><span class="p">,</span> <span class="n">TABLE_KWARGS</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>

<span class="n">DEFAULT_ONSPD_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span> <span class="s2">&quot;onspd&quot;</span><span class="p">)</span>
<span class="n">DEFAULT_REPORT_EVERY</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">DEFAULT_COMMIT_EVERY</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">YEAR_MONTH_FMT</span> <span class="o">=</span> <span class="s2">&quot;%Y%m&quot;</span>

<span class="n">CODE_LEN</span> <span class="o">=</span> <span class="mi">9</span>  <span class="c1"># many ONSPD codes have this length</span>
<span class="n">NAME_LEN</span> <span class="o">=</span> <span class="mi">80</span>  <span class="c1"># seems about right; a bit more than the length of many</span>


<span class="c1"># =============================================================================</span>
<span class="c1"># Ancillary functions</span>
<span class="c1"># =============================================================================</span>

<span class="k">def</span> <span class="nf">convert_date</span><span class="p">(</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                   <span class="n">YEAR_MONTH_FMT</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">convert_float</span><span class="p">(</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()):</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>


<div class="viewcode-block" id="values_from_row"><a class="viewcode-back" href="../../../autodoc/preprocess/postcodes.html#crate_anon.preprocess.postcodes.values_from_row">[docs]</a><span class="k">def</span> <span class="nf">values_from_row</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Cell</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;For openpyxl interface to XLSX files.&quot;&quot;&quot;</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span></div>


<span class="k">def</span> <span class="nf">commit_and_announce</span><span class="p">(</span><span class="n">session</span><span class="p">:</span> <span class="n">Session</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;COMMIT&quot;</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>


<span class="c1"># =============================================================================</span>
<span class="c1"># Extend SQLAlchemy Base class</span>
<span class="c1"># http://docs.sqlalchemy.org/en/latest/orm/extensions/declarative/mixins.html</span>
<span class="c1"># =============================================================================</span>

<span class="k">class</span> <span class="nc">ExtendedBase</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">__table_args__</span> <span class="o">=</span> <span class="n">TABLE_KWARGS</span>


<span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ExtendedBase</span><span class="p">)</span>


<span class="c1"># =============================================================================</span>
<span class="c1"># Models: all postcodes</span>
<span class="c1"># =============================================================================</span>

<div class="viewcode-block" id="Postcode"><a class="viewcode-back" href="../../../autodoc/preprocess/postcodes.html#crate_anon.preprocess.postcodes.Postcode">[docs]</a><span class="k">class</span> <span class="nc">Postcode</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Maps individual postcodes to... lots of things. Large table.&quot;&quot;&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&#39;postcode&#39;</span>

    <span class="n">pcd_nospace</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Postcode (no spaces)&quot;</span><span class="p">)</span>
    <span class="c1"># ... not in original, but simplifies indexing</span>
    <span class="n">pcd</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Unit postcode (7 characters): 2-4 char outward code, &quot;</span>
                     <span class="s2">&quot;left-aligned; 3-char inward code, right-aligned&quot;</span><span class="p">)</span>
    <span class="n">pcd2</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Unit postcode (8 characters): 2-4 char outward code, &quot;</span>
                      <span class="s2">&quot;left-aligned; space; 3-char inward code, right-aligned&quot;</span><span class="p">)</span>
    <span class="n">pcds</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Unit postcode (variable length): 2-4 char outward &quot;</span>
                      <span class="s2">&quot;code; space; 3-char inward code&quot;</span><span class="p">)</span>
    <span class="n">dointr</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Date</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Date of introduction (original format YYYYMM)&quot;</span><span class="p">)</span>
    <span class="n">doterm</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Date</span><span class="p">,</span>
                    <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Date of termination (original format YYYYMM) or NULL&quot;</span><span class="p">)</span>
    <span class="n">oscty</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                   <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;County code [FK to county_england_2010.county_code]&quot;</span><span class="p">)</span>
    <span class="n">oslaua</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                    <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Local authority district (LUA), unitary  authority &quot;</span>
                        <span class="s2">&quot;(UA), metropolitan district (MD), London borough (LB),&quot;</span>
                        <span class="s2">&quot; council area (CA), or district council area (DCA) &quot;</span>
                        <span class="s2">&quot;[FK to lad_local_authority_district_2016.lad_code]&quot;</span><span class="p">)</span>
    <span class="n">osward</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                    <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Electoral ward/division &quot;</span>
                        <span class="s2">&quot;[FK e.g. to electoral_ward_2016.ward_code]&quot;</span><span class="p">)</span>
    <span class="n">usertype</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Small (0) or large (1) postcode user&quot;</span><span class="p">)</span>
    <span class="n">oseast1m</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span>
                      <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;National grid reference Easting, 1m resolution&quot;</span><span class="p">)</span>
    <span class="n">osnrth1m</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span>
                      <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;National grid reference Northing, 1m resolution&quot;</span><span class="p">)</span>
    <span class="n">osgrdind</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span>
                      <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Grid reference positional quality indicator&quot;</span><span class="p">)</span>
    <span class="n">oshlthau</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Former (up to 2013) Strategic Health Authority (SHA), Local &quot;</span>
            <span class="s2">&quot;Health Board (LHB), Health Board (HB), Health Authority (HA), or &quot;</span>
            <span class="s2">&quot;Health &amp; Social Care Board (HSCB) [FK to one of: &quot;</span>
            <span class="s2">&quot;sha_strategic_health_authority_england_2010.sha_code or &quot;</span>
            <span class="s2">&quot;sha_strategic_health_authority_england_2004.sha_code; &quot;</span>
            <span class="s2">&quot;hb_health_board_n_ireland_2003.hb_code; &quot;</span>
            <span class="s2">&quot;hb_health_board_scotland_2014.hb_code; &quot;</span>
            <span class="s2">&quot;hscb_health_social_care_board_n_ireland_2010.hscb_code; &quot;</span>
            <span class="s2">&quot;lhb_local_health_board_wales_2014.lhb_code or &quot;</span>
            <span class="s2">&quot;lhb_local_health_board_wales_2006.lhb_code]&quot;</span><span class="p">)</span>
    <span class="n">hro</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                 <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Pan SHA [FK to &quot;</span>
                     <span class="s2">&quot;psha_pan_strategic_health_authority_aka_hro_england_2010&quot;</span>
                     <span class="s2">&quot;.psha_code]&quot;</span><span class="p">)</span>
    <span class="n">ctry</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                  <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Country of the UK [England, Scotland, Wales, &quot;</span>
                      <span class="s2">&quot;Northern Ireland] [FK to country_2012.country_code]&quot;</span><span class="p">)</span>
    <span class="n">gor</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                 <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Region (former GOR) [GOR = Government Office Regions] &quot;</span>
                     <span class="s2">&quot;[FK to gor_govt_office_region_england_2010.gor_code]&quot;</span><span class="p">)</span>
    <span class="n">streg</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Standard (Statistical) Region (SSR) [FK to &quot;</span>
                                <span class="s2">&quot;ssr_standard_statistical_region_england_1995.&quot;</span>
                                <span class="s2">&quot;ssr_code]&quot;</span><span class="p">)</span>
    <span class="n">pcon</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                  <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Westminster parliamentary constituency [FK to &quot;</span>
                      <span class="s2">&quot;pcon_westminster_parliamentary_constituency_2014.&quot;</span>
                      <span class="s2">&quot;pcon_code]&quot;</span><span class="p">)</span>
    <span class="n">eer</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                 <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;European Electoral Region (EER) [FK to &quot;</span>
                     <span class="s2">&quot;eer_european_electoral_region_2010.eer_code]&quot;</span><span class="p">)</span>
    <span class="n">teclec</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Local Learning and Skills Council (LLSC) / Dept. of Children, &quot;</span>
            <span class="s2">&quot;Education, Lifelong Learning and Skills (DCELLS) / Enterprise &quot;</span>
            <span class="s2">&quot;Region (ER) [PROBABLY FK to one of: &quot;</span>
            <span class="s2">&quot;dcells_dept_children_wales_2010.dcells_code; &quot;</span>
            <span class="s2">&quot;er_enterprise_region_scotland_2010.er_code; &quot;</span>
            <span class="s2">&quot;llsc_local_learning_skills_council_england_2010.llsc_code]&quot;</span><span class="p">)</span>
    <span class="n">ttwa</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                  <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Travel to Work Area (TTWA) [FK to &quot;</span>
                      <span class="s2">&quot;ttwa_travel_to_work_area_2011.ttwa_code]&quot;</span><span class="p">)</span>
    <span class="n">pct</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Primary Care Trust (PCT) / Care Trust / Care Trust Plus (CT) / &quot;</span>
            <span class="s2">&quot;Local Health Board (LHB) / Community Health Partnership (CHP) / &quot;</span>
            <span class="s2">&quot;Local Commissioning Group (LCG) / Primary Healthcare Directorate &quot;</span>
            <span class="s2">&quot;(PHD) [FK to one of: &quot;</span>
            <span class="s2">&quot;pct_primary_care_trust_organization_england_2011.pct_code; &quot;</span>
            <span class="s2">&quot;chp_community_health_partnership_scotland_2012.chp_code; &quot;</span>
            <span class="s2">&quot;lcg_local_commissioning_group_n_ireland_2010.lcg_code; &quot;</span>
            <span class="s2">&quot;lhb_local_health_board_wales_2014.lhb_code]&quot;</span><span class="p">)</span>
    <span class="n">nuts</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                  <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;LAU2 areas [European Union spatial regions; Local &quot;</span>
                      <span class="s2">&quot;Adminstrative Unit, level 2] / Nomenclature of Units &quot;</span>
                      <span class="s2">&quot;for Territorial Statistics (NUTS) [FK to &quot;</span>
                      <span class="s2">&quot;lau_eu_local_administrative_unit_2015.lau2_code]&quot;</span><span class="p">)</span>
    <span class="n">psed</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
                  <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;1991 Census Enumeration District (ED) (as OGSS code) &quot;</span>
                      <span class="s2">&quot;[POSSIBLY FK to district_england_wales_1991.&quot;</span>
                      <span class="s2">&quot;district_code_ogss]&quot;</span><span class="p">)</span>
    <span class="n">cened</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
                   <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;1991 Census Enumeration District (ED) (as Census code)&quot;</span>
                       <span class="s2">&quot; [POSSIBLY FK to district_england_wales_1991.&quot;</span>
                       <span class="s2">&quot;district_code_census]&quot;</span><span class="p">)</span>
    <span class="n">edind</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;ED positional quality indicator (PQI)&quot;</span><span class="p">)</span>
    <span class="n">oshaprev</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Previous Strategic Health Authority (SHA) / Health Board (HB) / &quot;</span>
            <span class="s2">&quot;Health Authority (HA) / Health and Social Services Board (HSSB) &quot;</span>
            <span class="s2">&quot;[FK to one of: &quot;</span>
            <span class="s2">&quot;sha_strategic_health_authority_england_2010.sha_code or &quot;</span>
            <span class="s2">&quot;sha_strategic_health_authority_england_2004.sha_code]&quot;</span><span class="p">)</span>
    <span class="n">lea</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                 <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Previous Local Education Authority (LEA) / Education &quot;</span>
                     <span class="s2">&quot;and Library Board (ELB) [PROBABLY FK to &quot;</span>
                     <span class="s2">&quot;lea_local_education_authority_2009.lea_code]&quot;</span><span class="p">)</span>
    <span class="n">oldha</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                   <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Old-style health authority (prior to 2002 &quot;</span>
                       <span class="s2">&quot;England, 2003 Wales [FK to &quot;</span>
                       <span class="s2">&quot;ha_health_authority_2001.ha_code]&quot;</span><span class="p">)</span>
    <span class="n">wardc91</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                     <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;1991 administrative and electoral area (as Census &quot;</span>
                         <span class="s2">&quot;code) [FK to electoral_ward_1991.ward_code_census]&quot;</span><span class="p">)</span>
    <span class="n">wardo91</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                     <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;1991 administrative and electoral area (as OGSS &quot;</span>
                         <span class="s2">&quot;code) [FK to electoral_ward_1991.ward_code_ogss]&quot;</span><span class="p">)</span>
    <span class="n">ward98</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                    <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;1998 administrative and electoral area [FK to &quot;</span>
                        <span class="s2">&quot;electoral_ward_1998.ward_code]&quot;</span><span class="p">)</span>
    <span class="n">statsward</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;2005 &#39;statistical&#39; ward [?FK to &quot;</span>
                           <span class="s2">&quot;electoral_ward_2005.ward_code]&quot;</span><span class="p">)</span>
    <span class="n">oa01</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;2001 Census Output Area (OA). (There are &quot;</span>
                                  <span class="s2">&quot;about 222,000, so ~300 population?)&quot;</span><span class="p">)</span>
    <span class="n">casward</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                     <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Census Area Statistics (CAS) ward [PROBABLY FK to &quot;</span>
                         <span class="s2">&quot;cas_ward_2003.cas_ward_code]&quot;</span><span class="p">)</span>
    <span class="n">park</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;National park [FK to &quot;</span>
                                        <span class="s2">&quot;park_national_park_2010.park_code]&quot;</span><span class="p">)</span>
    <span class="n">lsoa01</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;2001 Census Lower Layer Super Output Area (LSOA) [England &amp; &quot;</span>
            <span class="s2">&quot;Wales, ~1,500 population] / Data Zone (DZ) [Scotland] / Super &quot;</span>
            <span class="s2">&quot;Output Area (SOA) [FK to one of: &quot;</span>
            <span class="s2">&quot;lsoa_lower_layer_super_output_area_england_wales_2004.lsoa_code; &quot;</span>
            <span class="s2">&quot;lsoa_lower_layer_super_output_area_n_ireland_2005.lsoa_code]&quot;</span><span class="p">)</span>
    <span class="n">msoa01</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;2001 Census Middle Layer Super Output Area (MSOA) [England &amp; &quot;</span>
            <span class="s2">&quot;Wales, ~7,200 population] / Intermediate Zone (IZ) [Scotland] &quot;</span>
            <span class="s2">&quot;[FK to one of: &quot;</span>
            <span class="s2">&quot;msoa_middle_layer_super_output_area_england_wales_2004.msoa_code;&quot;</span>
            <span class="s2">&quot; iz_intermediate_zone_scotland_2005.iz_code]&quot;</span><span class="p">)</span>
    <span class="n">ur01ind</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
                     <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;2001 Census urban/rural indicator [numeric in &quot;</span>
                         <span class="s2">&quot;England/Wales/Scotland; letters in N. Ireland]&quot;</span><span class="p">)</span>
    <span class="n">oac01</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                   <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;2001 Census Output Area classification (OAC)&quot;</span>
                       <span class="s2">&quot;[POSSIBLY FK to output_area_classification_2011.&quot;</span>
                       <span class="s2">&quot;subgroup_code]&quot;</span><span class="p">)</span>
    <span class="n">oldpct</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Old (pre-Oct 2006) Primary Care Trust (PCT) / Local Health Board &quot;</span>
            <span class="s2">&quot;(LHB) / Care Trust (CT) [FK to one of: &quot;</span>
            <span class="s2">&quot;pct_primary_care_trust_organization_england_2005.pct_code]&quot;</span><span class="p">)</span>
    <span class="n">oa11</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                  <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;2011 Census Output Area (OA) [England, Wales, Scotland;&quot;</span>
                      <span class="s2">&quot; ~100-625 population] / Small Area (SA) [N. Ireland]&quot;</span><span class="p">)</span>
    <span class="n">lsoa11</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;2011 Census Lower Layer Super Output Area (LSOA) [England &amp; &quot;</span>
            <span class="s2">&quot;Wales, ~1,500 population] / Data Zone (DZ) [Scotland] / Super &quot;</span>
            <span class="s2">&quot;Output Area (SOA) [FK to one of: &quot;</span>
            <span class="s2">&quot;lsoa_lower_layer_super_output_area_england_wales_2011.lsoa_code;&quot;</span>
            <span class="s2">&quot; dz_datazone_scotland_2011.dz_code]&quot;</span><span class="p">)</span>
    <span class="n">msoa11</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;2011 Census Middle Layer Super Output Area (MSOA) [England &amp; &quot;</span>
            <span class="s2">&quot;Wales, ~7,200 population] / Intermediate Zone (IZ) [Scotland] &quot;</span>
            <span class="s2">&quot;[FK to one of: &quot;</span>
            <span class="s2">&quot;msoa_middle_layer_super_output_area_england_wales_2011.msoa_code;&quot;</span>
            <span class="s2">&quot; iz_intermediate_zone_scotland_2011.iz_code]&quot;</span><span class="p">)</span>
    <span class="n">parish</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                    <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Parish/community [FK to &quot;</span>
                        <span class="s2">&quot;parish_lad_england_wales_2014.parish_code; &quot;</span>
                        <span class="s2">&quot;ncp_non_civil_parish_2014.ncp_code]&quot;</span><span class="p">)</span>
    <span class="n">wz11</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;2011 Census Workplace Zone (WZ)&quot;</span><span class="p">)</span>
    <span class="n">ccg</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Clinical Commissioning Group (CCG) / Local Health Board (LHB) / &quot;</span>
            <span class="s2">&quot;Community Health Partnership (CHP) / Local Commissioning Group &quot;</span>
            <span class="s2">&quot;(LCG) / Primary Healthcare Directorate (PHD) [FK to one of: &quot;</span>
            <span class="s2">&quot;ccg_clinical_commissioning_group_england_2015.&quot;</span>
            <span class="s2">&quot;ccg_ons_code, lhb_local_health_board_wales_2014.lhb_code]&quot;</span><span class="p">)</span>
    <span class="n">bua11</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                   <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Built-up Area (BUA) [FK to &quot;</span>
                       <span class="s2">&quot;bua_built_up_area_england_wales_2013.bua_code]&quot;</span><span class="p">)</span>
    <span class="n">buasd11</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Built-up Area Sub-division (BUASD) [FK to &quot;</span>
            <span class="s2">&quot;buasd_built_up_area_subdivision_england_wales_2013.buas_code]&quot;</span><span class="p">)</span>
    <span class="n">ru11ind</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;2011 Census rural-urban classification&quot;</span><span class="p">)</span>
    <span class="n">oac11</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                   <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;2011 Census Output Area classification (OAC) [FK to &quot;</span>
                       <span class="s2">&quot;output_area_classification_2011.subgroup_code]&quot;</span><span class="p">)</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Numeric</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
                 <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Latitude (degrees, 6dp)&quot;</span><span class="p">)</span>
    <span class="n">long</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Numeric</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
                  <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Longitude (degrees, 6dp)&quot;</span><span class="p">)</span>
    <span class="n">lep1</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Local Enterprise Partnership (LEP) - first instance [FK to &quot;</span>
            <span class="s2">&quot;lep_local_enterprise_partnership_england_2013.lep1_code]&quot;</span><span class="p">)</span>
    <span class="n">lep2</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Local Enterprise Partnership (LEP) - second instance [FK to &quot;</span>
            <span class="s2">&quot;lep_local_enterprise_partnership_england_2013.lep1_code]&quot;</span><span class="p">)</span>
    <span class="n">pfa</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span>
                 <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Police Force Area (PFA) [FK to &quot;</span>
                     <span class="s2">&quot;pfa_police_force_area_2015.pfa_code]&quot;</span><span class="p">)</span>
    <span class="n">imd</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span>
        <span class="n">Integer</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Index of Multiple Deprivation (IMD) [rank of LSOA/DZ, where 1 is &quot;</span>
            <span class="s2">&quot;the most deprived, within each country] [FK to one of: &quot;</span>
            <span class="s2">&quot;imd_index_multiple_deprivation_england_2015.imd_rank; &quot;</span>
            <span class="s2">&quot;imd_index_multiple_deprivation_n_ireland_2010.imd_rank; &quot;</span>
            <span class="s2">&quot;imd_index_multiple_deprivation_scotland_2012.imd_rank; &quot;</span>
            <span class="s2">&quot;imd_index_multiple_deprivation_wales_2014.imd_rank]&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">convert_date</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;dointr&#39;</span><span class="p">)</span>
        <span class="n">convert_date</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;doterm&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;usertype&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;oseast1m&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;osnrth1m&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;osgrdind&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;streg&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;edind&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;imd&#39;</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;pcd_nospace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;pcd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<span class="c1"># =============================================================================</span>
<span class="c1"># Models: core lookup tables</span>
<span class="c1"># =============================================================================</span>

<span class="k">class</span> <span class="nc">OAClassification</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;2011 Census Output Area Classification Names and Codes &quot;</span> \
                   <span class="s2">&quot;UK.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;output_area_classification_2011&quot;</span>

    <span class="n">supergroup_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">supergroup_desc</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span>
    <span class="n">group_desc</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
    <span class="n">group_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">subgroup_desc</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span>
    <span class="n">subgroup_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;Supergroup&#39;</span><span class="p">,</span> <span class="s1">&#39;supergroup_desc&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;Group&#39;</span><span class="p">,</span> <span class="s1">&#39;group_desc&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;Subgroup&#39;</span><span class="p">,</span> <span class="s1">&#39;subgroup_desc&#39;</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;supergroup_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;supergroup_desc&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;group_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;group_desc&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;subgroup_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;subgroup_desc&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">BUA</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;BUA_names and codes EW as at 12_13.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;bua_built_up_area_england_wales_2013&quot;</span>

    <span class="n">bua_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">bua_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;BUA13CD&#39;</span><span class="p">,</span> <span class="s1">&#39;bua_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;BUA13NM&#39;</span><span class="p">,</span> <span class="s1">&#39;bua_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">BUASD</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;BUASD_names and codes EW as at 12_13.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;buasd_built_up_area_subdivision_england_wales_2013&quot;</span>

    <span class="n">buasd_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">buasd_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;BUASD13CD&#39;</span><span class="p">,</span> <span class="s1">&#39;buasd_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;BUASD13NM&#39;</span><span class="p">,</span> <span class="s1">&#39;buasd_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">CASWard</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;CAS ward names and codes UK as at 01_03.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;cas_ward_2003&quot;</span>

    <span class="n">cas_ward_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">cas_ward_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;WDCAS03CD&#39;</span><span class="p">,</span> <span class="s1">&#39;cas_ward_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;WDCAS03NM&#39;</span><span class="p">,</span> <span class="s1">&#39;cas_ward_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">CCG</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;CCG names and codes EN as at 07_15.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;ccg_clinical_commissioning_group_england_2015&quot;</span>

    <span class="n">ccg_ons_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ccg_ccg_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">ccg_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;CCG15CD&#39;</span><span class="p">,</span> <span class="s1">&#39;ccg_ons_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;CCG15CDH&#39;</span><span class="p">,</span> <span class="s1">&#39;ccg_ccg_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;CCG15NM&#39;</span><span class="p">,</span> <span class="s1">&#39;ccg_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">CHP</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;CHP names and codes SC as at 04_12.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;chp_community_health_partnership_scotland_2012&quot;</span>

    <span class="n">chp_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">chp_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;CHP12CD&#39;</span><span class="p">,</span> <span class="s1">&#39;chp_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;CHP12NM&#39;</span><span class="p">,</span> <span class="s1">&#39;chp_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Country</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Country names and codes UK as at 08_12.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;country_2012&quot;</span>

    <span class="n">country_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">country_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>
    <span class="n">country_name_welsh</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;CTRY12CD&#39;</span><span class="p">,</span> <span class="s1">&#39;country_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;CTRY12NM&#39;</span><span class="p">,</span> <span class="s1">&#39;country_name&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;CTRY12NMW&#39;</span><span class="p">,</span> <span class="s1">&#39;country_name_welsh&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">County1991</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;County names and codes EW as at 21_04_91.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;county_england_wales_1991&quot;</span>
    <span class="n">__headings__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;county_code_census&quot;</span><span class="p">,</span> <span class="s2">&quot;county_code_ogss&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;county_code_ons&quot;</span><span class="p">,</span> <span class="s2">&quot;county_name&quot;</span><span class="p">]</span>
    <span class="c1"># __debug_content__ = True</span>

    <span class="n">county_code_census</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">county_code_ogss</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">county_code_ons</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">county_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># ... no code type is present for all counties</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># The &quot;00&quot; codes are stored in the spreadsheet as a numeric 0 with</span>
        <span class="c1"># leading zero formatting.</span>
        <span class="k">def</span> <span class="nf">process_00</span><span class="p">(</span><span class="n">field</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:0&gt;2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

        <span class="n">process_00</span><span class="p">(</span><span class="s1">&#39;county_code_census&#39;</span><span class="p">)</span>
        <span class="n">process_00</span><span class="p">(</span><span class="s1">&#39;county_code_ogss&#39;</span><span class="p">)</span>
        <span class="n">process_00</span><span class="p">(</span><span class="s1">&#39;county_code_ons&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">County2010</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;County names and codes EN as at 12_10.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;county_england_2010&quot;</span>

    <span class="n">county_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">county_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;CTY10CD&#39;</span><span class="p">,</span> <span class="s1">&#39;county_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;CTY10NM&#39;</span><span class="p">,</span> <span class="s1">&#39;county_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Datazone</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Datazone (2011) names and codes SC as at 11_14.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;dz_datazone_scotland_2011&quot;</span>

    <span class="n">dz_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dz_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;DZ11CD&#39;</span><span class="p">,</span> <span class="s1">&#39;dz_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;DZ11NM&#39;</span><span class="p">,</span> <span class="s1">&#39;dz_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">DCELLS</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;DCELLS names and codes WA as at 12_10.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;dcells_dept_children_wales_2010&quot;</span>

    <span class="n">dcells_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dcells_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;DCELL10CD&#39;</span><span class="p">,</span> <span class="s1">&#39;dcells_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;DCELL10NM&#39;</span><span class="p">,</span> <span class="s1">&#39;dcells_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        

<span class="k">class</span> <span class="nc">District</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;District names and codes EW as at 21_4_91.xls&quot;</span>
    <span class="n">__headings__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;district_name&quot;</span><span class="p">,</span> <span class="s2">&quot;district_code_census&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;district_code_ogss&quot;</span><span class="p">,</span> <span class="s2">&quot;district_code_ons&quot;</span><span class="p">]</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;district_england_wales_1991&quot;</span>

    <span class="n">district_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>
    <span class="n">district_code_census</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">district_code_ogss</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">district_code_ons</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">EER</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;EER names and codes UK as at 12_10.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;eer_european_electoral_region_2010&quot;</span>

    <span class="n">eer_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">eer_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;EER10CD&#39;</span><span class="p">,</span> <span class="s1">&#39;eer_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;EER10NM&#39;</span><span class="p">,</span> <span class="s1">&#39;eer_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">EnterpriseRegion</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Enterprise Region names and codes SC as at 12_10.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;er_enterprise_region_scotland_2010&quot;</span>

    <span class="n">er_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">er_code_old</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">er_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;ER10CD&#39;</span><span class="p">,</span> <span class="s1">&#39;er_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;ER10CDO&#39;</span><span class="p">,</span> <span class="s1">&#39;er_code_old&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;ER10NM&#39;</span><span class="p">,</span> <span class="s1">&#39;er_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">HealthAuthority</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Health Authority &amp; Health Board names and codes GB as &quot;</span> \
                   <span class="s2">&quot;at 12_01.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;ha_health_authority_2001&quot;</span>

    <span class="n">ha_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ha_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;HA01CD&#39;</span><span class="p">,</span> <span class="s1">&#39;ha_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;HA01NM&#39;</span><span class="p">,</span> <span class="s1">&#39;ha_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">HealthBoardNI</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Health Board names and codes NI as at 2003.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;hb_health_board_n_ireland_2003&quot;</span>

    <span class="n">hb_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">hb_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;HA03CD&#39;</span><span class="p">,</span> <span class="s1">&#39;hb_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;HA03NM&#39;</span><span class="p">,</span> <span class="s1">&#39;hb_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">HealthBoardSC</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Health Board names and codes SC as at 12_14.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;hb_health_board_scotland_2014&quot;</span>

    <span class="n">hb_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">hb_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;HB14CD&#39;</span><span class="p">,</span> <span class="s1">&#39;hb_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;HB14NM&#39;</span><span class="p">,</span> <span class="s1">&#39;hb_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">HSCBNI</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;HSCB name and code NI as at 12_10.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;hscb_health_social_care_board_n_ireland_2010&quot;</span>

    <span class="n">hscb_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">hscb_code_2</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">hscb_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;HSCB10CDO&#39;</span><span class="p">,</span> <span class="s1">&#39;hscb_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;HSCB10CD&#39;</span><span class="p">,</span> <span class="s1">&#39;hscb_code_2&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;HSCB10NM&#39;</span><span class="p">,</span> <span class="s1">&#39;hscb_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">IMDLookupEN</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;IMD lookup EN as at 12_15.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;imd_index_multiple_deprivation_england_2015&quot;</span>

    <span class="n">lsoa_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lsoa_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>
    <span class="n">imd_rank</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LSOA11CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LSOA11NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa_name&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;IMD15&#39;</span><span class="p">,</span> <span class="s1">&#39;imd_rank&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;imd_rank&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">IMDLookupNI</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;IMD lookup NI as at 12_10.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;imd_index_multiple_deprivation_n_ireland_2010&quot;</span>

    <span class="n">oa_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">imd_rank</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;OA01CD&#39;</span><span class="p">,</span> <span class="s1">&#39;oa_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;IMD10&#39;</span><span class="p">,</span> <span class="s1">&#39;imd_rank&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;imd_rank&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">IMDLookupSC</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;IMD lookup SC as at 12_12.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;imd_index_multiple_deprivation_scotland_2012&quot;</span>

    <span class="n">dz_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">imd_rank</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;DZ01CD&#39;</span><span class="p">,</span> <span class="s1">&#39;dz_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;IMD12&#39;</span><span class="p">,</span> <span class="s1">&#39;imd_rank&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;imd_rank&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">IMDLookupWA</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;IMD lookup WA as at 12_14.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;imd_index_multiple_deprivation_wales_2014&quot;</span>

    <span class="n">lsoa_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lsoa_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>
    <span class="n">imd_rank</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LSOA11CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LSOA11NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa_name&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;IMD14&#39;</span><span class="p">,</span> <span class="s1">&#39;imd_rank&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;imd_rank&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">IZ2005</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;IZ (2001) names and codes SC as at 11_11.xls&quot;</span>
    <span class="c1"># definitely 2005, from metadata</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;iz_intermediate_zone_scotland_2005&quot;</span>

    <span class="n">iz_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">iz_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;IZ05CD&#39;</span><span class="p">,</span> <span class="s1">&#39;iz_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;IZ05NM&#39;</span><span class="p">,</span> <span class="s1">&#39;iz_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">IZ2011</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;IZ (2011) names and codes SC as at 11_14.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;iz_intermediate_zone_scotland_2011&quot;</span>

    <span class="n">iz_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">iz_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;IZ11CD&#39;</span><span class="p">,</span> <span class="s1">&#39;iz_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;IZ11NM&#39;</span><span class="p">,</span> <span class="s1">&#39;iz_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">LAU</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;LAU215_LAU115_NUTS315_NUTS215_NUTS115_UK_LUv2.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;lau_eu_local_administrative_unit_2015&quot;</span>

    <span class="n">lau2_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lau2_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>
    <span class="n">lau1_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">))</span>
    <span class="n">lau1_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>
    <span class="n">nuts3_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">nuts3_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>
    <span class="n">nuts2_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">nuts2_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>
    <span class="n">nuts1_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">nuts1_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LAU215CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lau2_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LAU215NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lau2_name&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LAU115CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lau1_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LAU115NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lau1_name&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;NUTS315CD&#39;</span><span class="p">,</span> <span class="s1">&#39;nuts3_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;NUTS315NM&#39;</span><span class="p">,</span> <span class="s1">&#39;nuts3_name&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;NUTS215CD&#39;</span><span class="p">,</span> <span class="s1">&#39;nuts2_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;NUTS215NM&#39;</span><span class="p">,</span> <span class="s1">&#39;nuts2_name&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;NUTS115CD&#39;</span><span class="p">,</span> <span class="s1">&#39;nuts1_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;NUTS115NM&#39;</span><span class="p">,</span> <span class="s1">&#39;nuts1_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">LAD</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;LA_UA names and codes UK as at 02_16.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;lad_local_authority_district_2016&quot;</span>

    <span class="n">lad_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lad_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LAD16CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lad_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LAD16NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lad_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">LCG</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;LCG names and codes NI as at 12_10.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;lcg_local_commissioning_group_n_ireland_2010&quot;</span>

    <span class="n">lcg_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">))</span>
    <span class="n">lcg_code_old</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lcg_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LCG10CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lcg_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LCG10CDO&#39;</span><span class="p">,</span> <span class="s1">&#39;lcg_code_old&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LCG10NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lcg_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">LEA</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;LEA and ELB names and codes UK as at 04_09.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;lea_local_education_authority_2009&quot;</span>
    <span class="c1"># __debug_content__ = True</span>

    <span class="n">lea_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lea_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;EDUC09CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lea_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;EDUC09NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lea_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">LEP</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;LEP names and codes EN as at 12_13.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;lep_local_enterprise_partnership_england_2013&quot;</span>
    <span class="c1"># __debug_content__ = True</span>

    <span class="n">lep1_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lep1_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LEP13CD1&#39;</span><span class="p">,</span> <span class="s1">&#39;lep1_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LEP13NM1&#39;</span><span class="p">,</span> <span class="s1">&#39;lep1_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">LHB2014</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;LHB names and codes WA as at 12_14.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;lhb_local_health_board_wales_2014&quot;</span>
    <span class="c1"># __debug_content__ = True</span>

    <span class="n">lhb_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lhb_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>
    <span class="n">lhb_name_welsh</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LHB14CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lhb_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LHB14NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lhb_name&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LHB14NMW&#39;</span><span class="p">,</span> <span class="s1">&#39;lhb_name_welsh&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">LHB2006</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Local Health Boards names and codes WA as at 06_06.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;lhb_local_health_board_wales_2006&quot;</span>

    <span class="n">lhb_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lhb_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LHB06CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lhb_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LHB06NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lhb_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">LLSC</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;LLSC names and codes EN as at 12_10.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;llsc_local_learning_skills_council_england_2010&quot;</span>

    <span class="n">llsc_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">llsc_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LLSC10CD&#39;</span><span class="p">,</span> <span class="s1">&#39;llsc_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LLSC10NM&#39;</span><span class="p">,</span> <span class="s1">&#39;llsc_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">LSOAEW2004</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;LSOA (2001) names and codes EW as at 02_04.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;lsoa_lower_layer_super_output_area_england_wales_2004&quot;</span>

    <span class="n">lsoa_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lsoa_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LSOA04CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LSOA04NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">LSOANI2005</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;LSOA (2001) names and codes NI as at 02_05.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;lsoa_lower_layer_super_output_area_n_ireland_2005&quot;</span>

    <span class="n">lsoa_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lsoa_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LSOAN05CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LSOAN05NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">LSOAEW2011</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;LSOA (2011) names and codes EW as at 12_12.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;lsoa_lower_layer_super_output_area_england_wales_2011&quot;</span>

    <span class="n">lsoa_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lsoa_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LSOA11CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LSOA11NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MSOAEW2004</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;MSOA (2001) names and codes EW as at 08_04.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;msoa_middle_layer_super_output_area_england_wales_2004&quot;</span>

    <span class="n">msoa_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">msoa_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;MSOA04CD&#39;</span><span class="p">,</span> <span class="s1">&#39;msoa_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;MSOA04NM&#39;</span><span class="p">,</span> <span class="s1">&#39;msoa_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MSOAEW2011</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;MSOA (2011) names and codes EW as at 12_12.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;msoa_middle_layer_super_output_area_england_wales_2011&quot;</span>

    <span class="n">msoa_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">msoa_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;MSOA11CD&#39;</span><span class="p">,</span> <span class="s1">&#39;msoa_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;MSOA11NM&#39;</span><span class="p">,</span> <span class="s1">&#39;msoa_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">NationalPark</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;National Park names and codes GB as at 10_10.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;park_national_park_2010&quot;</span>

    <span class="n">park_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">park_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;NPARK10CD&#39;</span><span class="p">,</span> <span class="s1">&#39;park_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;NPARK10NM&#39;</span><span class="p">,</span> <span class="s1">&#39;park_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">PanSHA</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Pan SHA names and codes EN as at 12_10.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;psha_pan_strategic_health_authority_aka_hro_england_2010&quot;</span>

    <span class="n">psha_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">psha_code_old</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">psha_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PSHA10CD&#39;</span><span class="p">,</span> <span class="s1">&#39;psha_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PSHA10CDO&#39;</span><span class="p">,</span> <span class="s1">&#39;psha_code_old&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PSHA10NM&#39;</span><span class="p">,</span> <span class="s1">&#39;psha_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Parish</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Parish LAD names and codes EW as at 12_14.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;parish_lad_england_wales_2014&quot;</span>

    <span class="n">parish_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">parish_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>
    <span class="n">district_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">))</span>
    <span class="n">district_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PAR14CD&#39;</span><span class="p">,</span> <span class="s1">&#39;parish_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PAR14NM&#39;</span><span class="p">,</span> <span class="s1">&#39;parish_name&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LAD14CD&#39;</span><span class="p">,</span> <span class="s1">&#39;district_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LAD14NM&#39;</span><span class="p">,</span> <span class="s1">&#39;district_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">PCT2011</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;PCO names and codes EN as at 04_11.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;pct_primary_care_trust_organization_england_2011&quot;</span>

    <span class="n">pct_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pct_code_old</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">pct_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PCO11CD&#39;</span><span class="p">,</span> <span class="s1">&#39;pct_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PCO11CDO&#39;</span><span class="p">,</span> <span class="s1">&#39;pct_code_old&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PCO11NM&#39;</span><span class="p">,</span> <span class="s1">&#39;pct_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">PCT2005</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;PCO names and codes EN as at 10_05.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;pct_primary_care_trust_organization_england_2005&quot;</span>

    <span class="n">pct_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pct_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PCO05CD&#39;</span><span class="p">,</span> <span class="s1">&#39;pct_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PCO05NM&#39;</span><span class="p">,</span> <span class="s1">&#39;pct_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">PFA</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;PFA names and codes GB as at 12_15.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;pfa_police_force_area_2015&quot;</span>

    <span class="n">pfa_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pfa_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PFA15CD&#39;</span><span class="p">,</span> <span class="s1">&#39;pfa_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PFA15NM&#39;</span><span class="p">,</span> <span class="s1">&#39;pfa_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">GOR</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Region (GOR) names and codes EN as at 12_10.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;gor_govt_office_region_england_2010&quot;</span>

    <span class="n">gor_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gor_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>
    <span class="n">gor_name_welsh</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;GOR10CD&#39;</span><span class="p">,</span> <span class="s1">&#39;gor_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;GOR10NM&#39;</span><span class="p">,</span> <span class="s1">&#39;gor_name&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;GOR10NMW&#39;</span><span class="p">,</span> <span class="s1">&#39;gor_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">SHA2004</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;SHA names and codes EN as at 09_02_04.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;sha_strategic_health_authority_england_2004&quot;</span>

    <span class="n">sha_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sha_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;SHA04CD&#39;</span><span class="p">,</span> <span class="s1">&#39;sha_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;SHA04NM&#39;</span><span class="p">,</span> <span class="s1">&#39;sha_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">SHA2010</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;SHA names and codes EN as at 12_10.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;sha_strategic_health_authority_england_2010&quot;</span>

    <span class="n">sha_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sha_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;SHA10CD&#39;</span><span class="p">,</span> <span class="s1">&#39;sha_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;SHA10NM&#39;</span><span class="p">,</span> <span class="s1">&#39;sha_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">SSR</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;SSR names and codes EN as at 12_05.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;ssr_standard_statistical_region_england_1995&quot;</span>

    <span class="n">ssr_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ssr_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;SSR95CD&#39;</span><span class="p">,</span> <span class="s1">&#39;ssr_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;SSR95NM&#39;</span><span class="p">,</span> <span class="s1">&#39;ssr_name&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;ssr_code&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Ward1991</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Ward names and codes UK as at 21_04_91.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;electoral_ward_1991&quot;</span>

    <span class="n">ward_code_ons</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ward_code_census</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ward_code_ogss</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ward_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;WD91CD&#39;</span><span class="p">,</span> <span class="s1">&#39;ward_code_ons&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;WD91CDC&#39;</span><span class="p">,</span> <span class="s1">&#39;ward_code_census&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;WD91CDO&#39;</span><span class="p">,</span> <span class="s1">&#39;ward_code_ogss&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;WD91NM&#39;</span><span class="p">,</span> <span class="s1">&#39;ward_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Ward1998</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Ward names and codes UK as at 12_98.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;electoral_ward_1998&quot;</span>

    <span class="n">ward_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ward_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;WD98CD&#39;</span><span class="p">,</span> <span class="s1">&#39;ward_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;WD98NM&#39;</span><span class="p">,</span> <span class="s1">&#39;ward_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Ward2005</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Statistical ward names and codes UK as at 2005.xls&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;electoral_ward_2005&quot;</span>

    <span class="n">ward_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ward_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;WDSTL05CD&#39;</span><span class="p">,</span> <span class="s1">&#39;ward_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;WDSTL05NM&#39;</span><span class="p">,</span> <span class="s1">&#39;ward_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Ward2016</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Ward names and codes UK as at 05_16.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;electoral_ward_2016&quot;</span>

    <span class="n">ward_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ward_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;WD16CD&#39;</span><span class="p">,</span> <span class="s1">&#39;ward_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;WD16NM&#39;</span><span class="p">,</span> <span class="s1">&#39;ward_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">TTWA</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;TTWA names and codes UK as at 12_11 v5.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;ttwa_travel_to_work_area_2011&quot;</span>

    <span class="n">ttwa_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ttwa_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;TTWA11CD&#39;</span><span class="p">,</span> <span class="s1">&#39;ttwa_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;TTWA11NM&#39;</span><span class="p">,</span> <span class="s1">&#39;ttwa_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">NCP</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Unparished areas names and codes EN as at 12_14.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;ncp_non_civil_parish_2014&quot;</span>

    <span class="n">ncp_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ncp_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;NCP14CD&#39;</span><span class="p">,</span> <span class="s1">&#39;ncp_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;NCP14NM&#39;</span><span class="p">,</span> <span class="s1">&#39;ncp_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">WestminsterConstituency</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;Westminster Parliamentary Constituency names and codes &quot;</span> \
                   <span class="s2">&quot;UK as at 12_14.xlsx&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;pcon_westminster_parliamentary_constituency_2014&quot;</span>

    <span class="n">pcon_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pcon_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PCON14CD&#39;</span><span class="p">,</span> <span class="s1">&#39;pcon_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;PCON14NM&#39;</span><span class="p">,</span> <span class="s1">&#39;pcon_name&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="c1"># =============================================================================</span>
<span class="c1"># Models: centroids</span>
<span class="c1"># =============================================================================</span>
<span class="c1"># http://webarchive.nationalarchives.gov.uk/20160105160709/http://www.ons.gov.uk/ons/guide-method/geography/products/census/spatial/centroids/index.html</span>
<span class="c1">#</span>
<span class="c1"># Looking at lower_layer_super_output_areas_(e+w)_2011_population_weighted_centroids_v2.zip : # noqa</span>
<span class="c1"># - LSOA_2011_EW_PWC.shp -- probably a Shape file;</span>
<span class="c1">#   ... yes</span>
<span class="c1">#   ... https://en.wikipedia.org/wiki/Shapefile</span>
<span class="c1">#   ... ... describes most of the other files</span>
<span class="c1"># - LSOA_2011_EW_PWC_COORD_V2.CSV  -- LSOA to centroid coordinates</span>

<span class="k">class</span> <span class="nc">PopWeightedCentroidsLsoa2011</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">__filename__</span> <span class="o">=</span> <span class="s2">&quot;LSOA_2011_EW_PWC_COORD_V2.CSV&quot;</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;pop_weighted_centroids_lsoa_2011&quot;</span>
    <span class="c1"># __debug_content__ = True</span>

    <span class="n">lsoa_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">CODE_LEN</span><span class="p">),</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lsoa_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">NAME_LEN</span><span class="p">))</span>
    <span class="n">bng_north</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;British National Grid, North (m)&quot;</span><span class="p">)</span>
    <span class="n">bng_east</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;British National Grid, East (m)&quot;</span><span class="p">)</span>
    <span class="c1"># https://en.wikipedia.org/wiki/Ordnance_Survey_National_Grid#All-numeric_grid_references  # noqa</span>
    <span class="n">latitude</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Numeric</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
                      <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Latitude (degrees, 10dp)&quot;</span><span class="p">)</span>
    <span class="n">longitude</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Numeric</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Longitude (degrees, 10dp)&quot;</span><span class="p">)</span>
    <span class="c1"># ... there are some with 10dp, e.g. 0.0000570995</span>
    <span class="c1"># ... (precision - scale) = number of digits before &#39;.&#39;</span>
    <span class="c1"># ... which can&#39;t be more than 3 for any latitude/longitude</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LSOA11CD&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa_code&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LSOA11NM&#39;</span><span class="p">,</span> <span class="s1">&#39;lsoa_name&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;BNGNORTH&#39;</span><span class="p">,</span> <span class="s1">&#39;bng_north&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;BNGEAST&#39;</span><span class="p">,</span> <span class="s1">&#39;bng_east&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LONGITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
        <span class="n">rename_key</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;LATITUDE&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
        <span class="c1"># MySQL doesn&#39;t care if you pass a string to a numeric field, but</span>
        <span class="c1"># SQL server does. So:</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;bng_north&#39;</span><span class="p">)</span>
        <span class="n">convert_int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;bng_east&#39;</span><span class="p">)</span>
        <span class="n">convert_float</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
        <span class="n">convert_float</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lsoa_code</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t have a blank lsoa_code&quot;</span><span class="p">)</span>


<span class="c1"># =============================================================================</span>
<span class="c1"># Files -&gt; table data</span>
<span class="c1"># =============================================================================</span>

<span class="k">def</span> <span class="nf">populate_postcode_table</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                            <span class="n">session</span><span class="p">:</span> <span class="n">Session</span><span class="p">,</span>
                            <span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
                            <span class="n">commit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">tablename</span> <span class="o">=</span> <span class="n">Postcode</span><span class="o">.</span><span class="n">__tablename__</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">Postcode</span><span class="o">.</span><span class="n">__table__</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">replace</span><span class="p">:</span>
        <span class="n">engine</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">bind</span>
        <span class="k">if</span> <span class="n">engine</span><span class="o">.</span><span class="n">has_table</span><span class="p">(</span><span class="n">tablename</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Table </span><span class="si">{}</span><span class="s2"> exists; skipping&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tablename</span><span class="p">))</span>
            <span class="k">return</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Dropping/recreating table: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tablename</span><span class="p">))</span>
    <span class="n">table</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">checkfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">checkfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using ONSPD data file: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">n_inserted</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">extra_fields</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">db_fields</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">Postcode</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                       <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;pcd_nospace&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">args</span><span class="o">.</span><span class="n">reportevery</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Processing row </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2"> inserted)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">n</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;pcds&#39;</span><span class="p">],</span> <span class="n">n_inserted</span><span class="p">))</span>
                <span class="c1"># log.debug(row)</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">file_fields</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="n">missing_fields</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">db_fields</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">file_fields</span><span class="p">))</span>
                <span class="n">extra_fields</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">file_fields</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">db_fields</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">missing_fields</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Fields in database but not file: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span>
                                <span class="p">(</span><span class="n">missing_fields</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">extra_fields</span><span class="p">:</span>
                    <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Fields in file but not database : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">extra_fields</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">extra_fields</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">row</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">startswith</span><span class="p">:</span>
                <span class="n">ok</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">startswith</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;pcd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
                        <span class="n">ok</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">ok</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">Postcode</span><span class="p">(</span><span class="o">**</span><span class="n">row</span><span class="p">)</span>
            <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">n_inserted</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">commit</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">%</span> <span class="n">args</span><span class="o">.</span><span class="n">commitevery</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">commit_and_announce</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">commit</span><span class="p">:</span>
        <span class="n">commit_and_announce</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>


<span class="c1"># BASETYPE = TypeVar(&#39;BASETYPE&#39;, bound=Base)</span>
<span class="c1"># http://mypy.readthedocs.io/en/latest/kinds_of_types.html</span>
<span class="c1"># https://docs.python.org/3/library/typing.html</span>


<div class="viewcode-block" id="populate_generic_lookup_table"><a class="viewcode-back" href="../../../autodoc/preprocess/postcodes.html#crate_anon.preprocess.postcodes.populate_generic_lookup_table">[docs]</a><span class="k">def</span> <span class="nf">populate_generic_lookup_table</span><span class="p">(</span><span class="n">sa_class</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>  <span class="c1"># Type[Base], Type[BASETYPE] fail on methods  # noqa</span>
                                  <span class="n">datadir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                                  <span class="n">session</span><span class="p">:</span> <span class="n">Session</span><span class="p">,</span>
                                  <span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
                                  <span class="n">commit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The .TXT files look at first glance like tab-separated values files,</span>
<span class="sd">    but in some cases have inconsistent numbers of tabs (e.g. &quot;2011 Census</span>
<span class="sd">    Output Area Classification Names and Codes UK.txt&quot;). So we&#39;ll use the</span>
<span class="sd">    .XLSX files.</span>

<span class="sd">    If the headings parameter is passed, those headings are used. Otherwise,</span>
<span class="sd">    the first row is used for headings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tablename</span> <span class="o">=</span> <span class="n">sa_class</span><span class="o">.</span><span class="n">__tablename__</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">find_first</span><span class="p">(</span><span class="n">sa_class</span><span class="o">.</span><span class="n">__filename__</span><span class="p">,</span> <span class="n">datadir</span><span class="p">)</span>
    <span class="n">headings</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sa_class</span><span class="p">,</span> <span class="s1">&#39;__headings__&#39;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">debug</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sa_class</span><span class="p">,</span> <span class="s1">&#39;__debug_content__&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">replace</span><span class="p">:</span>
        <span class="n">engine</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">bind</span>
        <span class="k">if</span> <span class="n">engine</span><span class="o">.</span><span class="n">has_table</span><span class="p">(</span><span class="n">tablename</span><span class="p">):</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Table </span><span class="si">{}</span><span class="s2"> exists; skipping&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tablename</span><span class="p">))</span>
            <span class="k">return</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Dropping/recreating table: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tablename</span><span class="p">))</span>
    <span class="n">sa_class</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">checkfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sa_class</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">checkfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Processing file &quot;</span><span class="si">{}</span><span class="s1">&quot; -&gt; table &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">tablename</span><span class="p">))</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">type_xlsx</span> <span class="o">=</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">]</span>
    <span class="n">type_csv</span> <span class="o">=</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.csv&#39;</span><span class="p">]</span>
    <span class="n">file</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: TextIO</span>

    <span class="k">def</span> <span class="nf">dict_from_rows</span><span class="p">(</span><span class="n">row_iterator</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">List</span><span class="p">])</span> \
            <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="n">local_headings</span> <span class="o">=</span> <span class="n">headings</span>
        <span class="n">first_row</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">row_iterator</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">values_from_row</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">first_row</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">local_headings</span><span class="p">:</span>
                <span class="n">local_headings</span> <span class="o">=</span> <span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">local_headings</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>
            <span class="n">first_row</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">type_xlsx</span><span class="p">:</span>
        <span class="n">workbook</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># read_only=True</span>
        <span class="c1"># openpyxl BUG: with read_only=True, cells can have None as their value</span>
        <span class="c1"># when they&#39;re fine if opened in non-read-only mode.</span>
        <span class="c1"># May be related to this:</span>
        <span class="c1"># https://bitbucket.org/openpyxl/openpyxl/issues/601/read_only-cell-row-column-attributes-are  # noqa</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">active</span>
        <span class="n">dict_iterator</span> <span class="o">=</span> <span class="n">dict_from_rows</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">())</span>
    <span class="k">elif</span> <span class="n">type_csv</span><span class="p">:</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">csv_reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">dict_iterator</span> <span class="o">=</span> <span class="n">csv_reader</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">workbook</span> <span class="o">=</span> <span class="n">xlrd</span><span class="o">.</span><span class="n">open_workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">sheet_by_index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">dict_iterator</span> <span class="o">=</span> <span class="n">dict_from_rows</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">get_rows</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">datadict</span> <span class="ow">in</span> <span class="n">dict_iterator</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">datadict</span><span class="p">))</span>
        <span class="c1"># filter out blanks:</span>
        <span class="n">datadict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">datadict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span><span class="p">}</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">sa_class</span><span class="p">(</span><span class="o">**</span><span class="n">datadict</span><span class="p">)</span>
        <span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">commit</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">%</span> <span class="n">args</span><span class="o">.</span><span class="n">commitevery</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">commit_and_announce</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">commit</span><span class="p">:</span>
        <span class="n">commit_and_announce</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;... inserted </span><span class="si">{}</span><span class="s2"> rows&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<span class="c1"># =============================================================================</span>
<span class="c1"># Docs</span>
<span class="c1"># =============================================================================</span>

<span class="k">def</span> <span class="nf">show_docs</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Postcode</span><span class="o">.</span><span class="n">__table__</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="n">prettytable</span><span class="o">.</span><span class="n">PrettyTable</span><span class="p">(</span>
        <span class="p">[</span><span class="s2">&quot;postcode field&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">],</span>
        <span class="c1"># header=False,</span>
        <span class="n">border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">hrules</span><span class="o">=</span><span class="n">prettytable</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span>
        <span class="n">vrules</span><span class="o">=</span><span class="n">prettytable</span><span class="o">.</span><span class="n">NONE</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">pt</span><span class="o">.</span><span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span>
    <span class="n">pt</span><span class="o">.</span><span class="n">valign</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span>
    <span class="n">pt</span><span class="o">.</span><span class="n">max_width</span> <span class="o">=</span> <span class="mi">80</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">Postcode</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">doc</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">docx_process_simple_text</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
        <span class="n">ptrow</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="p">,</span> <span class="n">doc</span><span class="p">]</span>
        <span class="n">pt</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">ptrow</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">get_string</span><span class="p">())</span>


<span class="c1"># =============================================================================</span>
<span class="c1"># Main</span>
<span class="c1"># =============================================================================</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawDescriptionHelpFormatter</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">-   This program reads data from the UK Office of National Statistics Postcode</span>
<span class="sd">    Database (ONSPD) and inserts it into a database.</span>

<span class="sd">-   You will need to download the ONSPD from</span>
<span class="sd">        https://geoportal.statistics.gov.uk/geoportal/catalog/content/filelist.page</span>
<span class="sd">    e.g. ONSPD_MAY_2016_csv.zip (79 Mb), and unzip it (&gt;1.4 Gb) to a directory.</span>
<span class="sd">    Tell this program which directory you used.</span>

<span class="sd">-   Specify your database as an SQLAlchemy connection URL: see</span>
<span class="sd">        http://docs.sqlalchemy.org/en/latest/core/engines.html</span>
<span class="sd">    The general format is:</span>
<span class="sd">        dialect[+driver]://username:password@host[:port]/database[?key=value...]</span>

<span class="sd">-   If you get an error like:</span>
<span class="sd">        UnicodeEncodeError: &#39;latin-1&#39; codec can&#39;t encode character &#39;\u2019&#39; in</span>
<span class="sd">        position 33: ordinal not in range(256)</span>
<span class="sd">    then try appending &quot;?charset=utf8&quot; to the connection URL.</span>

<span class="sd">-   ONS POSTCODE DATABASE LICENSE.</span>
<span class="sd">    Output using this program must add the following attribution statements:</span>

<span class="sd">    Contains OS data © Crown copyright and database right [year]</span>
<span class="sd">    Contains Royal Mail data © Royal Mail copyright and database right [year]</span>
<span class="sd">    Contains National Statistics data © Crown copyright and database right [year]</span>

<span class="sd">    See http://www.ons.gov.uk/methodology/geography/licences</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--dir&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">DEFAULT_ONSPD_DIR</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Root directory of unzipped ONSPD download (default: </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">DEFAULT_ONSPD_DIR</span><span class="p">))</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--url&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;SQLAlchemy database URL&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--echo&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Echo SQL&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--reportevery&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">DEFAULT_REPORT_EVERY</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Report every n rows (default: </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">DEFAULT_REPORT_EVERY</span><span class="p">))</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--commitevery&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">DEFAULT_COMMIT_EVERY</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="p">(</span>
            <span class="s2">&quot;Commit every n rows (default: </span><span class="si">{}</span><span class="s2">). If you make this too large &quot;</span>
            <span class="s2">&quot;(relative e.g. to your MySQL max_allowed_packet setting, you may&quot;</span>
            <span class="s2">&quot; get crashes with errors like &#39;MySQL has gone away&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">DEFAULT_COMMIT_EVERY</span><span class="p">)))</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--startswith&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Restrict to postcodes that start with one of these strings&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--replace&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Replace tables even if they exist (default: skip existing &quot;</span>
             <span class="s2">&quot;tables)&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--skiplookup&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Skip generation of code lookup tables&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--specific_lookup_tables&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Within the lookup tables, process only specific named tables&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--list_lookup_tables&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;List all possible lookup tables, then stop&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--skippostcodes&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Skip generation of main (large) postcode table&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--docsonly&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Show help for postcode table then stop&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="s2">&quot;--verbose&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Verbose&quot;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">rootlogger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
    <span class="n">configure_logger_for_colour</span><span class="p">(</span>
        <span class="n">rootlogger</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span> <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">verbose</span> <span class="k">else</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;args = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">args</span><span class="p">)))</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">docsonly</span><span class="p">:</span>
        <span class="n">show_docs</span><span class="p">()</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">classlist</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c1"># Core lookup tables:</span>
        <span class="c1"># In alphabetical order of filename:</span>
        <span class="n">OAClassification</span><span class="p">,</span>
        <span class="n">BUA</span><span class="p">,</span>
        <span class="n">BUASD</span><span class="p">,</span>
        <span class="n">CASWard</span><span class="p">,</span>
        <span class="n">CCG</span><span class="p">,</span>
        <span class="n">CHP</span><span class="p">,</span>
        <span class="n">Country</span><span class="p">,</span>
        <span class="n">County2010</span><span class="p">,</span>
        <span class="n">County1991</span><span class="p">,</span>
        <span class="n">Datazone</span><span class="p">,</span>
        <span class="n">DCELLS</span><span class="p">,</span>
        <span class="n">District</span><span class="p">,</span>
        <span class="n">EER</span><span class="p">,</span>
        <span class="n">EnterpriseRegion</span><span class="p">,</span>
        <span class="n">HealthAuthority</span><span class="p">,</span>
        <span class="n">HealthBoardNI</span><span class="p">,</span>
        <span class="n">HealthBoardSC</span><span class="p">,</span>
        <span class="n">HSCBNI</span><span class="p">,</span>
        <span class="n">IMDLookupEN</span><span class="p">,</span>
        <span class="n">IMDLookupNI</span><span class="p">,</span>
        <span class="n">IMDLookupSC</span><span class="p">,</span>
        <span class="n">IMDLookupWA</span><span class="p">,</span>
        <span class="n">IZ2005</span><span class="p">,</span>
        <span class="n">IZ2011</span><span class="p">,</span>
        <span class="n">LAU</span><span class="p">,</span>
        <span class="n">LAD</span><span class="p">,</span>
        <span class="n">LCG</span><span class="p">,</span>
        <span class="n">LEA</span><span class="p">,</span>
        <span class="n">LEP</span><span class="p">,</span>
        <span class="n">LHB2006</span><span class="p">,</span>
        <span class="n">LLSC</span><span class="p">,</span>
        <span class="n">LHB2014</span><span class="p">,</span>
        <span class="n">LSOAEW2004</span><span class="p">,</span>
        <span class="n">LSOANI2005</span><span class="p">,</span>
        <span class="n">LSOAEW2011</span><span class="p">,</span>
        <span class="n">MSOAEW2004</span><span class="p">,</span>
        <span class="n">MSOAEW2011</span><span class="p">,</span>
        <span class="n">NationalPark</span><span class="p">,</span>
        <span class="n">PanSHA</span><span class="p">,</span>
        <span class="n">Parish</span><span class="p">,</span>
        <span class="n">PCT2011</span><span class="p">,</span>
        <span class="n">PCT2005</span><span class="p">,</span>
        <span class="n">PFA</span><span class="p">,</span>
        <span class="n">GOR</span><span class="p">,</span>
        <span class="n">SHA2004</span><span class="p">,</span>
        <span class="n">SHA2010</span><span class="p">,</span>
        <span class="n">SSR</span><span class="p">,</span>
        <span class="n">Ward2005</span><span class="p">,</span>
        <span class="n">TTWA</span><span class="p">,</span>
        <span class="n">NCP</span><span class="p">,</span>
        <span class="n">Ward2016</span><span class="p">,</span>
        <span class="n">Ward1998</span><span class="p">,</span>
        <span class="n">Ward1991</span><span class="p">,</span>
        <span class="n">WestminsterConstituency</span><span class="p">,</span>
        <span class="c1"># Centroids:</span>
        <span class="n">PopWeightedCentroidsLsoa2011</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">list_lookup_tables</span><span class="p">:</span>
        <span class="n">tables_files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sa_class</span> <span class="ow">in</span> <span class="n">classlist</span><span class="p">:</span>
            <span class="n">tables_files</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sa_class</span><span class="o">.</span><span class="n">__tablename__</span><span class="p">,</span>
                                 <span class="n">sa_class</span><span class="o">.</span><span class="n">__filename__</span><span class="p">))</span>
        <span class="n">tables_files</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">table</span><span class="p">,</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">tables_files</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Table </span><span class="si">{}</span><span class="s2"> from file </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">file</span><span class="p">)))</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">url</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Must specify URL&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">echo</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">echo</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">CHARSET</span><span class="p">)</span>
    <span class="n">metadata</span><span class="o">.</span><span class="n">bind</span> <span class="o">=</span> <span class="n">engine</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">sessionmaker</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">engine</span><span class="p">)()</span>

    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using directory: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">dir</span><span class="p">))</span>
    <span class="c1"># lookupdir = os.path.join(args.dir, &quot;Documents&quot;)</span>
    <span class="n">lookupdir</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">dir</span>
    <span class="c1"># datadir = os.path.join(args.dir, &quot;Data&quot;)</span>
    <span class="n">datadir</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">dir</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">skiplookup</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">sa_class</span> <span class="ow">in</span> <span class="n">classlist</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">specific_lookup_tables</span> <span class="ow">and</span>
                    <span class="n">sa_class</span><span class="o">.</span><span class="n">__tablename__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">specific_lookup_tables</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sa_class</span><span class="o">.</span><span class="n">__tablename__</span> <span class="o">==</span>
                    <span class="s2">&quot;ccg_clinical_commissioning_group_england_2015&quot;</span><span class="p">):</span>
                <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Ignore warning &#39;Discarded range with reserved &quot;</span>
                            <span class="s2">&quot;name&#39; below; it works regardless&quot;</span><span class="p">)</span>
            <span class="n">populate_generic_lookup_table</span><span class="p">(</span><span class="n">sa_class</span><span class="p">,</span> <span class="n">lookupdir</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">skippostcodes</span><span class="p">:</span>
        <span class="n">populate_postcode_table</span><span class="p">(</span><span class="n">find_first</span><span class="p">(</span><span class="s2">&quot;ONSPD_*.csv&quot;</span><span class="p">,</span> <span class="n">datadir</span><span class="p">),</span>
                                <span class="n">session</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../../../index.html">Table Of Contents</a></h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/package_elements.html">2. Package elements in brief</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/publications.html">3. Reference publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/installation.html">4. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/database_drivers.html">5. Databases and database drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../anonymisation/index.html">6. Anonymisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nlp/index.html">7. Natural language processing (NLP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../website_config/index.html">8. Configuring the CRATE web interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../website_using/index.html">9. Using the CRATE web interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/ancillary_tools.html">10. Ancillary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/troubleshooting.html">11. Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/technical_notes.html">12. Technical notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/upgrading.html">13. Upgrading CRATE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/tcpip_ports.html">14. Common relevant TCP/IP ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autodoc/index.html">15. Automatic documentation of source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">16. Change log/history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/to_do.html">17. Things to do</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">18. Abbreviations and glossary</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">CRATE  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Rudolf Cardinal.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>